<!DOCTYPE html>
<html lang="en">
<head>
<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
<script id="shade_vert" type="x-shader/x-vertex">
precision mediump float;
uniform float X;
vec4 cubeColor = vec4(0,1,0,1);
mat4 viewpoint = mat4(1,0,0,0,0,.89,.45,0,0,-.45,.89,0,0,0,-4.47,1);
mat4 projection = mat4(1.30,0,0,0,0,1.73,0,0,0,0,-1,-1,0,0,-.2,0);
vec4 lightPos = vec4(.5,1,1,0);
attribute vec3 vPosition;
attribute vec3 vNormal;
varying vec4 C;
mat4 T(mat4 R) {
return mat4(
R[0][0],R[1][0],R[2][0],R[3][0],
R[0][1],R[1][1],R[2][1],R[3][1],
R[0][2],R[1][2],R[2][2],R[3][2],
R[0][3],R[1][3],R[2][3],R[3][3]
);
}
mat3 T(mat3 R) {
return mat3(
R[0][0],R[1][0],R[2][0],
R[0][1],R[1][1],R[2][1],
R[0][2],R[1][2],R[2][2]
);
}
mat4 I(mat3 R, vec3 t)
{
mat3 Rt = T(R);
vec3 th = Rt*t;
return mat4(
R[0][0], R[1][0], R[2][0], 0,
R[0][1], R[1][1], R[2][1], 0,
R[0][2], R[1][2], R[2][2], 0,
-th[0],  -th[1],  -th[2],  1
);
}

mat3 rx(float t) {
return mat3(
1,      0,       0,
0, cos(t), -sin(t),
0, sin(t),  cos(t)
);
}
mat3 ry(float t) {
return mat3(
cos(t), 0, sin(t),
0,       1,      0,
-sin(t), 0, cos(t)
);
}
mat4 view4(mat3 M) {
return mat4(
M[0][0],M[0][1],M[0][2],0,
M[1][0],M[1][1],M[1][2],0,
M[2][0],M[2][1],M[2][2],0,
0,0,0,1
);
}

void main(void)
{
float NdotL, diffuse;
mat3 R = rx(X) * ry(X/2.0);
mat4 view = viewpoint * view4(R);
mat4 normal = viewpoint * T(I(R, vec3(0,0,0)));
vec4 eyeNorm = normalize(normal * vec4(vNormal, 0));
vec4 vpos = view*vec4(vPosition,1);
vec4 lightDir = normalize(lightPos - vpos);
NdotL = max(dot(eyeNorm.xyz, lightDir.xyz), 0.0);
C = vec4(cubeColor.rgb * NdotL, 1);
gl_Position = projection * vpos;
}
</script>
<script id="shade_frag" type="x-shader/x-fragment">precision mediump float;varying vec4 C;void main(void){gl_FragColor=C;}</script>
<script src="dist/Cube.min.js"></script>
</head><body onload="start()"><canvas id="c" width="640" height="480"></canvas></body></html>

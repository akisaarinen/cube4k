<!DOCTYPE html>
<html lang="en">
<head>
<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
<script id="shade_vert" type="x-shader/x-vertex">
attribute vec3 vPosition,vNormal;
varying vec4 C;
uniform float X;
varying vec3 fragmentNormal;
mat4 projection = mat4(1.30,0,0,0,0,1.73,0,0,0,0,-1,-1,0,0,-.2,0);
uniform float time;

vec3 lightPosition = vec3(0,0,5);
varying vec3 lightVector;

mat4 translate(float x, float y, float z) {
  mat4 m = mat4(1.0);
  m[3][0] = x;
  m[3][1] = y;
  m[3][2] = z;
  return m;
}

mat4 rx(float t) {
  return mat4(
  1,      0,       0, 0,
  0, cos(t), -sin(t), 0,
  0, sin(t),  cos(t), 0,
  0,0,0,1
  );
}

void main() {
  mat4 transform = projection * translate(0.0, 0.0, -1.9) * rx(sin(time)*2.0);
  gl_Position    = (transform * vec4(vPosition, 1));
  fragmentNormal = (transform * vec4(vNormal,   1)).xyz;
  lightVector = lightPosition - vPosition;
  C = vec4(1,0,0,1);
}
</script>
<script id="shade_frag" type="x-shader/x-fragment">
precision mediump float;
varying vec4 C;
uniform float time;
uniform vec2 res;
varying vec3 fragmentNormal;
varying vec3 lightVector;
float MAX_DIST = 7.5;
float MAX_DIST_SQ = MAX_DIST * MAX_DIST;

void main(void){
  vec3 lightColor  = vec3(1,1,1);

  vec3 normal = normalize(fragmentNormal);

  float dist = min(dot(lightVector, lightVector), MAX_DIST_SQ) / MAX_DIST_SQ;
  float distFactor = 1.0 - dist;

  vec3 lightDir = normalize(lightVector);
  float diffuseDot = dot(normal, lightDir);
  vec3 diffuse = lightColor * clamp(diffuseDot, 0.0, 1.0) * distFactor;
  gl_FragColor = vec4(clamp((diffuse), 0.0, 1.0), 1);
}</script>
<script src="js/main.js"></script>
<!--<script src="dist/Cube.min.js"></script>-->
</head><body onload="start()"><canvas id="c" width="640" height="480"></canvas></body></html>
